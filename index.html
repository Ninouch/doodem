<!-- https://jeromeetienne.github.io/AR.js/three.js/examples/marker-training/examples/generator.html -->

<!DOCTYPE html>
<!-- script src="https://cdn.jsdelivr.net/gh/aframevr/aframe@1c2407b26c61958baa93967b5412487cd94b290b/dist/aframe-master.min.js"></script>-->
<!-- include aframe-ar.js -->
<!-- <script src="lib/aframe-ar.min.js"></script>-->

<style>

	#scan-interface{
		display: flex;
		justify-content: center;
		height: 100%;
		width: 100%;
		position: absolute;
		top: 0;
		left: 0;
		z-index: 2;
		background-color: transparent;
	}
	#interface{
		display: flex;
		justify-content: center;
		height: 100%;
		width: 100%;
		position: absolute;
		top: 0;
		left: 0;
		z-index: 3;
		background-color: transparent;
	}

</style>

<script src="https://aframe.io/releases/1.1.0/aframe.min.js"></script>
<script src="https://jeromeetienne.github.io/AR.js/aframe/build/aframe-ar.js"></script>
<!-- Register an aframe component that allows reacting to marker events -->
<script>
    window.addEventListener('camera-init', (data) => {
        console.log('camera-init', data);
    })

    window.addEventListener('camera-error', (error) => {
        console.log('camera-error', error);
    })

	AFRAME.registerComponent('registerevents', {
		init: function () {
			var marker = this.el;

			marker.addEventListener('markerFound', function() {
				var markerId = marker.id;
				console.log('markerFound', markerId);
				
				if(markerId === "repas"){
					document.getElementById("sprites").src = "/img/repas-interface.png";
				}

				if(markerId === "depenses"){
					document.getElementById("sprites").src = "/img/depenses-interface.png";
				}

				if(markerId === "message"){
				}

				if(markerId === "courses"){
					document.getElementById("sprites").src = "/img/courses-interface.png";
				}


				if(markerId === "menage"){
					document.getElementById("sprites").src = "/img/menage-interface.png";
				}

				if(markerId === "loisirs"){
					document.getElementById("sprites").src = "/img/loisirs-interface.png";
				}
				// TODO: Add your own code here to react to the marker being found.
			});

			marker.addEventListener('markerLost', function() {
				var markerId = marker.id;
				console.log('markerLost', markerId);
				// TODO: Add your own code here to react to the marker being lost.
			});
		}
	});


	function hideSelf(target){
			target.src = "";
		}
</script>

<body style='margin : 0 0 0 0; overflow: hidden; font-family: Monospace;'>
	<div id="scan-interface">
		<img src="/img/scan-interface.png" alt="">
	</div>
	<div id="interface">
		<img id="sprites" src="" onclick="hideSelf(this)"/>
	</div>
	<div style='position: fixed; top: 10px; left: 5px; text-align: center; z-index: 1;'>
</div>
	<a-scene embedded vr-mode-ui="enabled: false" arjs='sourceType: webcam; trackingMethod:best; sourceWidth:1280; sourceHeight:960; displayWidth: 1280; displayHeight: 960; debugUIEnabled: false;'>
		<a-assets>
			<a-asset-item id="scene-obj" src="./model/heart.obj"></a-asset-item>
			<!-- <a-asset-item id="scene-mtl" src="./model/heart.mtl"></a-asset-item> -->
			<img id="my-image" src="music-player.png">
		  </a-assets>
		<!-- A dupliquer -->
		<a-marker type="pattern" id='repas' url="/marker/pattern-repas.patt" registerevents>
			<a-box position='0 0.5 0' material='opacity: 0.5; side: double;color:blue;'>
				<a-torus-knot radius='0.26' radius-tubular='0.05'
				animation="property: rotation; to:360 0 0; dur: 5000; easing: linear; loop: true">
				</a-torus-knot>
			</a-box>
		</a-marker>

		<a-marker type="pattern" id='depenses' url="/marker/pattern-depenses.patt" registerevents>
			<a-box position='0 0.5 0' material='opacity: 0.5; side: double;color:blue;'>
				<a-torus-knot radius='0.26' radius-tubular='0.05'
				animation="property: rotation; to:360 0 0; dur: 5000; easing: linear; loop: true">
				</a-torus-knot>
			</a-box>
		</a-marker>

		<a-marker type="pattern" id='message' url="/marker/pattern-message.patt" registerevents>
		
			<a-obj-model src="#scene-obj" color='red' position='-0,5 0 1' rotation='0 180 0' scale=" .0500 .0500 .0500"></a-obj-model>
			<a-obj-model src="#scene-obj" color='red' position='1 0 -0,2' rotation='0 180 0' scale=" .0500 .0500 .0500"></a-obj-model>
			<a-obj-model src="#scene-obj" color='red' position='-1 0 0' rotation='0 180 0' scale=" .0500 .0500 .0500"></a-obj-model>
			<!--<a-image src="./img/music-player.png" position='0 0 0' rotation='45 90 0' scale="0.25 1 1"></a-image>-->

			<!--
			<a-box position='0 0.5 0' material='opacity: 0.5; side: double;color:blue;'>
				<a-torus-knot radius='0.26' radius-tubular='0.05'
				animation="property: rotation; to:360 0 0; dur: 5000; easing: linear; loop: true">
				</a-torus-knot>
			</a-box>-->
		</a-marker>

		<a-marker type="pattern" id='courses' url="/marker/pattern-courses.patt" registerevents>
			<a-box position='0 0.5 0' material='opacity: 0.5; side: double;color:blue;'>
				<a-torus-knot radius='0.26' radius-tubular='0.05'
				animation="property: rotation; to:360 0 0; dur: 5000; easing: linear; loop: true">
				</a-torus-knot>
			</a-box>
		</a-marker>

		<a-marker type="pattern" id='menage' url="/marker/pattern-menage.patt" registerevents>
			<a-box position='0 0.5 0' material='opacity: 0.5; side: double;color:blue;'>
				<a-torus-knot radius='0.26' radius-tubular='0.05'
				animation="property: rotation; to:360 0 0; dur: 5000; easing: linear; loop: true">
				</a-torus-knot>
			</a-box>
		</a-marker>

		<a-marker type="pattern" id='loisirs' url="/marker/pattern-loisirs.patt" registerevents>
			<a-box position='0 0.5 0' material='opacity: 0.5; side: double;color:blue;'>
				<a-torus-knot radius='0.26' radius-tubular='0.05'
				animation="property: rotation; to:360 0 0; dur: 5000; easing: linear; loop: true">
				</a-torus-knot>
			</a-box>
		</a-marker>

		<!-- add a simple camera -->
		<a-entity camera></a-entity>
	</a-scene>
</body>
</html>
